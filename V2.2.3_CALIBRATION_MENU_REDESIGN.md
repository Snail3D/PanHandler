# V2.2.3 - Calibration Menu Redesign

**Status**: ‚úÖ COMPLETE  
**Date**: October 17, 2025

## Problem
The calibration screen layout needed reorganization:
- Coin circle was in the center of screen
- LOCK IN button was at bottom by itself
- No quick way to skip to map scale calibration
- Wasted vertical space in the layout

## Solution

### Visual Layout Changes

#### Before v2.2.3
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Coin Selector     ‚îÇ (top)
‚îÇ                     ‚îÇ
‚îÇ                     ‚îÇ
‚îÇ      ü™ô Coin        ‚îÇ (center - SCREEN_HEIGHT / 2)
‚îÇ                     ‚îÇ
‚îÇ                     ‚îÇ
‚îÇ                     ‚îÇ
‚îÇ   [LOCK IN]         ‚îÇ (bottom)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### After v2.2.3
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Coin Selector     ‚îÇ (top)
‚îÇ                     ‚îÇ
‚îÇ      ü™ô Coin        ‚îÇ (2/3 up - SCREEN_HEIGHT * 0.33)
‚îÇ                     ‚îÇ
‚îÇ                     ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ   ‚îÇ  [LOCK IN]    ‚îÇ ‚îÇ (menu card top)
‚îÇ   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îÇ
‚îÇ   ‚îÇQuarter‚îÇ Map   ‚îÇ ‚îÇ (bottom row)
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Changes Made

#### 1. **Coin Circle Position** (Line 268-275)
Moved from center to 2/3 up the screen:
```typescript
// Before:
const referenceCenterY = SCREEN_HEIGHT / 2;

// After:
const referenceCenterY = SCREEN_HEIGHT * 0.33; // Now at 1/3 from top (2/3 up from bottom)
```

#### 2. **Tutorial Finger Positions** (Line 69-73)
Updated to match new coin position:
```typescript
const leftFingerY = useSharedValue(SCREEN_HEIGHT * 0.33 + 100);
const rightFingerY = useSharedValue(SCREEN_HEIGHT * 0.33 + 100);
```

#### 3. **Tutorial Text Positions** (Lines 862-900)
Updated to appear above the moved coin circle:
```typescript
top: SCREEN_HEIGHT * 0.33 - 260, // Above coin at 1/3 height
top: SCREEN_HEIGHT * 0.33 - 220, // Pinch text above coin
```

#### 4. **Bottom Menu Card Redesign** (Lines 759-814)
Completely restructured with new layout:

**Menu Structure:**
- **Top**: LOCK IN button (full width)
- **Bottom Row**: Two buttons side-by-side
  - **Left**: Coin selector (shows selected coin, tap to change)
  - **Right**: Map button (skip to map scale)

**Visual Design:**
- Single glassmorphic card containing all controls
- Proper padding and spacing
- Blur effect with white tint
- Smooth press animations

#### 5. **Added `onSkipToMap` Prop** (Line 46)
```typescript
interface ZoomCalibrationProps {
  // ... existing props
  onSkipToMap?: () => void; // New: skip to measurement without coin calibration
}
```

#### 6. **Connected to MeasurementScreen** (Line 2004-2018)
```typescript
<ZoomCalibration
  // ... existing props
  onSkipToMap={() => {
    // Skip coin calibration, go straight to measurement screen
    // WITHOUT coin calibration data (no coin badge info)
    setMode('measurement');
  }}
/>
```

## User Flow

### Coin Calibration Path (Existing)
1. User selects coin from selector
2. User zooms/pans to align coin with circle
3. User taps **LOCK IN**
4. Goes to measurement screen with coin calibration
5. Badge shows: "üìê Quarter (25.0mm)"

### Map Scale Path (NEW)
1. User selects coin from selector (or not)
2. User taps **Map** button
3. Goes directly to measurement screen
4. **No coin calibration** badge shown
5. User can zoom/pan freely
6. User manually opens Map Scale modal when ready

## Technical Details

### Why Move Coin Up?
- Makes room for bigger menu at bottom
- Better visual balance
- Keeps menu controls in thumb-reachable zone
- Coin still clearly visible and well-positioned

### Why Add Map Button?
- Gives users choice: coin OR map calibration
- Eliminates need to go through coin flow if using map scale
- Lets users zoom/pan freely before setting map scale
- More flexible workflow

### Button Layout
The bottom row uses flexbox with gap:
```typescript
<View style={{ flexDirection: 'row', gap: 12 }}>
  <Pressable style={{ flex: 1 }}>Quarter</Pressable>
  <Pressable style={{ flex: 1 }}>Map</Pressable>
</View>
```

### Colors & Styling
- **LOCK IN**: Uses session color (cyan/magenta/yellow/etc.)
- **Coin Selector**: White glassmorphic background
- **Map Button**: Blue (`rgba(66, 165, 245, 0.8)`)
- **All buttons**: Proper press states, borders, shadows

## Files Modified

1. **`/src/components/ZoomCalibration.tsx`**
   - Line 46: Added `onSkipToMap` prop
   - Line 55: Added to function params
   - Lines 268-275: Moved coin circle to 2/3 height
   - Lines 69-73: Updated finger tutorial positions
   - Lines 862-900: Updated tutorial text positions
   - Lines 759-814: Complete bottom menu redesign

2. **`/src/screens/MeasurementScreen.tsx`**
   - Lines 2004-2018: Added `onSkipToMap` handler

## Visual Design

### Menu Card Appearance
- **Background**: `rgba(255, 255, 255, 0.45)` with 35 blur intensity
- **Border**: `rgba(255, 255, 255, 0.35)` 1px
- **Border Radius**: 24px
- **Padding**: 16px
- **Shadow**: Session color with 20px radius

### Button Sizes
- **LOCK IN**: Full width, 20px vertical padding, 38px font
- **Coin Selector**: flex: 1, 16px vertical padding, shows emoji + name + diameter
- **Map Button**: flex: 1, 16px vertical padding, shows icon + "Map Scale"

## Testing Checklist

- [ ] Coin circle appears at 2/3 up the screen (not center)
- [ ] Tutorial animations position correctly around moved coin
- [ ] Bottom menu card shows LOCK IN at top
- [ ] Coin selector shows selected coin info
- [ ] Map button appears next to coin selector
- [ ] Tapping coin selector reopens search
- [ ] Tapping Map button goes to measurement screen without calibration
- [ ] LOCK IN works as before
- [ ] All blur effects remain the same
- [ ] Button press states work smoothly
- [ ] Layout looks good on different screen sizes

## Known Limitations

- Map button only appears when `onSkipToMap` prop is provided
- Map button skips calibration entirely (no coin OR map scale set yet)
- User must manually open Map Scale modal after skipping

## Related Documentation

- `V2.2.0_QUICK_REFERENCE.md` - Blueprint scale feature
- `V2.2.2_QUICK_REFERENCE.md` - Blueprint cursor system

---

**Previous Version**: v2.2.2 (Blueprint Cursor System)  
**Next Version**: TBD
