# PanHandler v2.2.3 - Quick Reference

**Release Date**: October 17, 2025  
**Focus**: Calibration Menu Redesign

## What Changed

### New Calibration Screen Layout

The calibration screen has been reorganized for better space utilization and workflow:

✅ **Coin circle moved up** to 2/3 of screen height (was centered)  
✅ **Bottom menu card redesigned** with new structure  
✅ **LOCK IN button** now at top of menu card  
✅ **Coin selector + Map button** side-by-side below LOCK IN  
✅ **Map button** provides quick skip to measurement screen

### Visual Comparison

**Before:**
```
┌────────────────────┐
│  Coin Selector     │
│                    │
│     🪙 Coin        │ ← Center
│                    │
│                    │
│   [  LOCK IN  ]    │ ← Bottom
└────────────────────┘
```

**After:**
```
┌────────────────────┐
│  Coin Selector     │
│                    │
│     🪙 Coin        │ ← 2/3 up
│                    │
│ ┌────────────────┐ │
│ │   LOCK IN      │ │ ← Top of card
│ ├────────┬───────┤ │
│ │Quarter │ Map   │ │ ← Bottom row
│ └────────┴───────┘ │
└────────────────────┘
```

## New Features

### 1. Map Button
Quick access to skip coin calibration:

**What it does:**
- Skips coin calibration entirely
- Goes directly to measurement screen
- No calibration badge shown
- Allows user to zoom/pan freely first
- User manually opens Map Scale modal when ready

**When to use:**
- You want to use map scale instead of coin
- You want to zoom/pan before calibrating
- You don't have a reference coin available

### 2. Reorganized Menu
All controls now in one glassmorphic card:

**Top Button:**
- **LOCK IN** - Confirms coin calibration (same as before)

**Bottom Row (50/50 split):**
- **Left: Coin Selector** - Shows selected coin, tap to change
- **Right: Map Button** - Skip to measurement screen

## User Flows

### Flow 1: Standard Coin Calibration (Unchanged)
1. Select coin from search
2. Pinch/zoom to align coin with circle
3. Tap **LOCK IN**
4. Measurement screen opens with coin calibration
5. Badge shows: "📐 Quarter (25.0mm)"

### Flow 2: Skip to Map Scale (NEW)
1. Optionally select a coin (or skip this)
2. Tap **Map** button in bottom menu
3. Measurement screen opens WITHOUT calibration
4. Zoom/pan freely to explore image
5. When ready, tap "Map Scale" button
6. Set map scale using verbal or blueprint method

## Visual Design Details

### Coin Circle Position
- **Before**: Center of screen (`SCREEN_HEIGHT / 2`)
- **After**: Top third (`SCREEN_HEIGHT * 0.33`)
- **Reason**: Makes room for menu, better balance

### Menu Card Style
- Glassmorphic white background
- 35 intensity blur
- 24px border radius
- Session color shadow
- 16px padding

### Button Appearances

**LOCK IN:**
- Full width
- Session color background (cyan/magenta/yellow/etc.)
- 38px bold white text
- 20px vertical padding

**Coin Selector:**
- White glassmorphic background
- Shows 🪙 emoji
- Selected coin name
- Coin diameter (e.g., "25.0mm")

**Map Button:**
- Blue background (`rgba(66, 165, 245, 0.8)`)
- Map icon
- "Map Scale" text
- Press state animation

## Technical Changes

### Files Modified
1. `/src/components/ZoomCalibration.tsx`
   - Coin circle position moved to `SCREEN_HEIGHT * 0.33`
   - Tutorial positions updated
   - Bottom menu completely redesigned
   - Added `onSkipToMap` prop

2. `/src/screens/MeasurementScreen.tsx`
   - Added `onSkipToMap` handler
   - Skips to measurement mode without calibration

### Props Added
```typescript
interface ZoomCalibrationProps {
  // ... existing props
  onSkipToMap?: () => void; // NEW: Skip coin calibration
}
```

## What Stays the Same

✅ Coin circle size (130px radius = 260px diameter)  
✅ Blur effect on background outside circle  
✅ Dynamic blur intensity based on zoom  
✅ Glow effects and visual polish  
✅ Pinch-zoom tutorial animations  
✅ Coin selector search functionality  
✅ LOCK IN button functionality  
✅ Help button (top right)  
✅ Back button (left edge)

## Testing Guide

### Test Coin Calibration Path
1. Open calibration screen
2. Verify coin circle at 2/3 height (not center)
3. Select a coin (e.g., Quarter)
4. Verify bottom menu shows:
   - LOCK IN at top
   - Quarter button on left
   - Map button on right
5. Zoom coin to match circle
6. Tap LOCK IN
7. Verify measurement screen opens with calibration badge

### Test Map Skip Path
1. Open calibration screen
2. Select any coin (or don't)
3. Tap **Map** button (blue, right side)
4. Verify measurement screen opens
5. Verify NO calibration badge shown
6. Verify can zoom/pan freely
7. Tap "Map Scale" button
8. Verify map scale modal opens

### Visual Checks
- [ ] Coin circle positioned at 2/3 up screen
- [ ] Tutorial animations position correctly
- [ ] Bottom menu card has proper blur/transparency
- [ ] LOCK IN button at top of card
- [ ] Coin selector and Map button side-by-side
- [ ] All buttons have press animations
- [ ] Colors match design (session color for LOCK IN, blue for Map)

## Known Behavior

- Map button only appears in builds with `onSkipToMap` prop
- Skipping to measurement has NO calibration (not coin, not map)
- User must manually open Map Scale modal after skipping
- Coin selector still required to see LOCK IN button

---

**Previous Version**: v2.2.2 (Blueprint Cursor System)  
**Current Version**: v2.2.3 (Calibration Menu Redesign)  
**Next Version**: TBD
